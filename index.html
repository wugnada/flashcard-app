<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>ÌÖçÏä§Ìä∏ Ïó∞Ïäµ - ÏïàÎìúÎ°úÏù¥Îìú</title>
    
    <!-- PWA ÏÑ§Ï†ï -->
    <meta name="theme-color" content="#000000">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="ÌÖçÏä§Ìä∏Ïó∞Ïäµ">
    <meta name="description" content="ÏïàÎìúÎ°úÏù¥ÎìúÏö© ÌÖçÏä§Ìä∏ Ïó∞Ïäµ Ïï±">
    
    <!-- ÏïàÎìúÎ°úÏù¥Îìú Ï†ÑÏö© ÏïÑÏù¥ÏΩò -->
    <link rel="icon" sizes="192x192" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 192 192'><rect width='192' height='192' fill='%23000'/><text x='96' y='110' text-anchor='middle' fill='%2390EE90' font-size='80'>üìù</text></svg>">
    <link rel="icon" sizes="512x512" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'><rect width='512' height='512' fill='%23000'/><text x='256' y='300' text-anchor='middle' fill='%2390EE90' font-size='200'>üìù</text></svg>">
    
    <!-- Îß§ÎãàÌéòÏä§Ìä∏ -->
    <link rel="manifest" href="manifest.json">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        html, body {
            height: 100%;
            overflow: hidden;
            position: fixed;
            width: 100%;
        }

        body {
            font-family: 'Roboto', 'Noto Sans KR', sans-serif;
            background: linear-gradient(135deg, #000 0%, #111 100%);
            color: #90EE90;
            display: flex;
            flex-direction: column;
            touch-action: manipulation;
        }

        .app-container {
            display: flex;
            flex-direction: column;
            height: 100vh;
            width: 100vw;
        }

        .status-bar {
            background: rgba(0,0,0,0.9);
            backdrop-filter: blur(10px);
            padding: 0.75rem 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #333;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .status-left {
            display: flex;
            flex-direction: column;
            gap: 0.2rem;
        }

        .app-title {
            font-size: 1rem;
            font-weight: 700;
            color: #90EE90;
        }

        .usage-info {
            font-size: 0.75rem;
            color: #FFD700;
        }

        .status-right {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .typing-status {
            font-size: 1.2rem;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .typing-status.active {
            opacity: 1;
        }

        .menu-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #333;
            border: none;
            color: #90EE90;
            font-size: 1.2rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .menu-btn:active {
            background: #555;
            transform: scale(0.9);
        }

        .editor-container {
            flex: 1;
            position: relative;
            overflow: hidden;
        }

        .text-editor {
            width: 100%;
            height: 100%;
            background: transparent;
            color: #90EE90;
            border: none;
            outline: none;
            font-family: 'JetBrains Mono', 'Roboto Mono', monospace;
            font-size: 1.1rem;
            padding: 1rem;
            resize: none;
            line-height: 1.6;
            text-align: center;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .text-editor::placeholder {
            color: #555;
            text-align: center;
        }

        .floating-actions {
            position: fixed;
            bottom: 2rem;
            right: 1rem;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            z-index: 200;
        }

        .fab {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            border: none;
            color: white;
            font-size: 1.4rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 12px rgba(0,0,0,0.4);
        }

        .fab:active {
            transform: scale(0.9);
        }

        .fab.primary {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
        }

        .fab.danger {
            background: linear-gradient(135deg, #f44336 0%, #d32f2f 100%);
        }

        .fab.secondary {
            background: linear-gradient(135deg, #2196F3 0%, #1976D2 100%);
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 1rem;
            backdrop-filter: blur(5px);
        }

        .modal {
            background: linear-gradient(135deg, #111 0%, #000 100%);
            border: 2px solid #333;
            border-radius: 16px;
            padding: 1.5rem;
            width: 100%;
            max-width: 350px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.8);
            transform: scale(0.9);
            transition: transform 0.2s ease;
        }

        .modal-overlay.show .modal {
            transform: scale(1);
        }

        .modal-header {
            text-align: center;
            margin-bottom: 1.5rem;
        }

        .modal-title {
            color: #90EE90;
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .modal-subtitle {
            color: #FFD700;
            font-size: 0.85rem;
        }

        .settings-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.75rem;
            margin-bottom: 1.5rem;
        }

        .settings-item {
            background: #222;
            border: 2px solid #444;
            border-radius: 12px;
            padding: 1rem;
            text-align: center;
            color: #90EE90;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .settings-item:active {
            transform: scale(0.95);
        }

        .settings-item.active {
            background: #90EE90;
            color: #000;
            border-color: #90EE90;
        }

        .modal-actions {
            display: flex;
            gap: 0.75rem;
            justify-content: center;
        }

        .modal-btn {
            padding: 0.75rem 1.5rem;
            border: 2px solid #444;
            border-radius: 8px;
            background: #333;
            color: #90EE90;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.2s ease;
        }

        .modal-btn:active {
            transform: scale(0.95);
        }

        .modal-btn.primary {
            background: #90EE90;
            color: #000;
            border-color: #90EE90;
        }

        .install-prompt {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, #333 0%, #222 100%);
            padding: 1rem;
            display: none;
            align-items: center;
            justify-content: space-between;
            border-top: 2px solid #444;
            z-index: 300;
        }

        .install-text {
            color: #90EE90;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .install-btn {
            background: #90EE90;
            color: #000;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
        }

        .auto-clear-indicator {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 107, 107, 0.9);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 25px;
            font-size: 0.85rem;
            font-weight: 600;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 500;
            backdrop-filter: blur(10px);
        }

        .auto-clear-indicator.show {
            opacity: 1;
        }

        /* ÏïàÎìúÎ°úÏù¥Îìú Ï†ÑÏö© ÏµúÏ†ÅÌôî */
        @media (max-height: 600px) {
            .text-editor {
                font-size: 1rem;
                padding: 0.75rem;
            }
            
            .floating-actions {
                bottom: 1rem;
            }
        }

        /* ÏßÑÎèô ÌîºÎìúÎ∞± Ïï†ÎãàÎ©îÏù¥ÏÖò */
        .vibrate {
            animation: vibrate 0.3s ease-in-out;
        }

        @keyframes vibrate {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-2px); }
            75% { transform: translateX(2px); }
        }

        /* Ïä§ÌÅ¨Î°§Î∞î Ïä§ÌÉÄÏùº */
        .text-editor::-webkit-scrollbar {
            width: 6px;
        }

        .text-editor::-webkit-scrollbar-track {
            background: transparent;
        }

        .text-editor::-webkit-scrollbar-thumb {
            background: #444;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- ÏÉÅÌÉúÎ∞î -->
        <div class="status-bar">
            <div class="status-left">
                <div class="app-title">üìù ÌÖçÏä§Ìä∏ Ïó∞Ïäµ</div>
                <div class="usage-info" id="usageInfo">0Ï¥à ÏÇ¨Ïö© Ï§ë</div>
            </div>
            <div class="status-right">
                <div class="typing-status" id="typingStatus">‚å®Ô∏è</div>
                <button class="menu-btn" onclick="showMenu()">‚ãÆ</button>
            </div>
        </div>

        <!-- ÏóêÎîîÌÑ∞ -->
        <div class="editor-container">
            <textarea 
                class="text-editor" 
                id="textEditor" 
                placeholder="ÏïàÎìúÎ°úÏù¥ÎìúÏóêÏÑú ÌÖçÏä§Ìä∏ Ïó∞ÏäµÏùÑ ÏãúÏûëÌïòÏÑ∏Ïöî...&#10;&#10;5Ï¥àÍ∞Ñ ÌÉÄÏù¥ÌïëÏùÑ Î©àÏ∂îÎ©¥ ÏûêÎèôÏúºÎ°ú Ï¥àÍ∏∞ÌôîÎê©ÎãàÎã§"
                spellcheck="false"
                autocomplete="off"
                autocorrect="off"
                autocapitalize="off"
            ></textarea>
        </div>

        <!-- ÌîåÎ°úÌåÖ Ïï°ÏÖò Î≤ÑÌäº -->
        <div class="floating-actions">
            <button class="fab danger" onclick="clearText()" title="Ï¥àÍ∏∞Ìôî">üóëÔ∏è</button>
            <button class="fab secondary" onclick="copyText()" title="Î≥µÏÇ¨">üìã</button>
        </div>
    </div>

    <!-- ÏûêÎèô Ï¥àÍ∏∞Ìôî ÏïåÎ¶º -->
    <div class="auto-clear-indicator" id="autoClearIndicator">5Ï¥à ÌõÑ ÏûêÎèô Ï¥àÍ∏∞Ìôî</div>

    <!-- PWA ÏÑ§Ïπò ÌîÑÎ°¨ÌîÑÌä∏ -->
    <div class="install-prompt" id="installPrompt">
        <div class="install-text">üì± Ìôà ÌôîÎ©¥Ïóê Ïï±ÏúºÎ°ú Ï∂îÍ∞ÄÌïòÍ∏∞</div>
        <button class="install-btn" onclick="installApp()">Ï∂îÍ∞Ä</button>
    </div>

    <!-- Î©îÎâ¥ Î™®Îã¨ -->
    <div class="modal-overlay" id="menuModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">üìã Î©îÎâ¥</div>
            </div>
            
            <div class="settings-grid">
                <div class="settings-item" onclick="showSettings()">‚öôÔ∏è ÏÑ§Ï†ï</div>
                <div class="settings-item" onclick="clearText(); closeMenu();">üóëÔ∏è Ï¥àÍ∏∞Ìôî</div>
                <div class="settings-item" onclick="copyText(); closeMenu();">üìã Î≥µÏÇ¨</div>
                <div class="settings-item" onclick="shareApp(); closeMenu();">üì§ Í≥µÏú†</div>
            </div>

            <div class="modal-actions">
                <button class="modal-btn" onclick="resetStats()">ÌÜµÍ≥Ñ Ï¥àÍ∏∞Ìôî</button>
                <button class="modal-btn primary" onclick="closeMenu()">Îã´Í∏∞</button>
            </div>
        </div>
    </div>

    <!-- ÏÑ§Ï†ï Î™®Îã¨ -->
    <div class="modal-overlay" id="settingsModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">‚öôÔ∏è ÏÑ§Ï†ï</div>
            </div>
            
            <div class="modal-subtitle">Ìè∞Ìä∏ ÌÅ¨Í∏∞</div>
            <div class="settings-grid">
                <div class="settings-item" onclick="setFontSize(16)">ÏûëÍ≤å</div>
                <div class="settings-item" onclick="setFontSize(18)">Î≥¥ÌÜµ</div>
                <div class="settings-item" onclick="setFontSize(22)">ÌÅ¨Í≤å</div>
                <div class="settings-item" onclick="setFontSize(26)">Îß§Ïö∞ ÌÅ¨Í≤å</div>
            </div>

            <div class="modal-subtitle">ÏûêÎèô Ï¥àÍ∏∞Ìôî</div>
            <div class="settings-grid">
                <div class="settings-item" onclick="setAutoClearTime(0)">ÎÅÑÍ∏∞</div>
                <div class="settings-item" onclick="setAutoClearTime(3)">3Ï¥à</div>
                <div class="settings-item" onclick="setAutoClearTime(5)">5Ï¥à</div>
                <div class="settings-item" onclick="setAutoClearTime(10)">10Ï¥à</div>
            </div>

            <div class="modal-actions">
                <button class="modal-btn" onclick="closeSettings()">Ï∑®ÏÜå</button>
                <button class="modal-btn primary" onclick="closeSettings()">ÌôïÏù∏</button>
            </div>
        </div>
    </div>

    <script>
        // PWA ÏÑúÎπÑÏä§ ÏõåÏª§ Îì±Î°ù
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('./sw.js')
                .then(reg => console.log('ÏÑúÎπÑÏä§ ÏõåÏª§ Îì±Î°ù ÏÑ±Í≥µ'))
                .catch(err => console.log('ÏÑúÎπÑÏä§ ÏõåÏª§ Îì±Î°ù Ïã§Ìå®'));
        }

        // Ïï± ÏÑ§Ï†ï
        let appSettings = {
            fontSize: 18,
            autoClearTime: 5,
            totalUsageTime: 0,
            currentSessionTime: 0,
            lastActiveDate: new Date().toDateString()
        };

        let isTyping = false;
        let lastKeyTime = 0;
        let sessionTimer = null;
        let autoClearTimer = null;
        let deferredPrompt = null;

        // DOM ÏöîÏÜå
        const textEditor = document.getElementById('textEditor');
        const usageInfo = document.getElementById('usageInfo');
        const typingStatus = document.getElementById('typingStatus');
        const autoClearIndicator = document.getElementById('autoClearIndicator');
        const installPrompt = document.getElementById('installPrompt');

        // Ïï± Ï¥àÍ∏∞Ìôî
        function initApp() {
            loadSettings();
            updateUI();
            bindEvents();
            startSessionTimer();
            
            // PWA ÏÑ§Ïπò ÌîÑÎ°¨ÌîÑÌä∏ Ï≤òÎ¶¨
            window.addEventListener('beforeinstallprompt', (e) => {
                e.preventDefault();
                deferredPrompt = e;
                showInstallPrompt();
            });

            // ÏïàÎìúÎ°úÏù¥Îìú Îí§Î°úÍ∞ÄÍ∏∞ Î≤ÑÌäº Ï≤òÎ¶¨
            window.addEventListener('popstate', handleBackButton);
            
            setTimeout(() => textEditor.focus(), 100);
        }

        // ÏÑ§Ï†ï Î°úÎìú
        function loadSettings() {
            try {
                const saved = localStorage.getItem('androidTextEditorSettings');
                if (saved) {
                    const parsed = JSON.parse(saved);
                    appSettings = { ...appSettings, ...parsed };
                }
                
                // ÏÉàÎ°úÏö¥ ÎÇ†Ïù¥Î©¥ ÏÑ∏ÏÖò ÏãúÍ∞Ñ Ï¥àÍ∏∞Ìôî
                const today = new Date().toDateString();
                if (appSettings.lastActiveDate !== today) {
                    appSettings.currentSessionTime = 0;
                    appSettings.lastActiveDate = today;
                    saveSettings();
                }
            } catch (e) {
                console.log('ÏÑ§Ï†ï Î°úÎìú Ïã§Ìå®');
            }
        }

        // ÏÑ§Ï†ï Ï†ÄÏû•
        function saveSettings() {
            try {
                localStorage.setItem('androidTextEditorSettings', JSON.stringify(appSettings));
            } catch (e) {
                console.log('ÏÑ§Ï†ï Ï†ÄÏû• Ïã§Ìå®');
            }
        }

        // UI ÏóÖÎç∞Ïù¥Ìä∏
        function updateUI() {
            textEditor.style.fontSize = appSettings.fontSize + 'px';
            updateUsageDisplay();
            updateAutoClearPlaceholder();
        }

        // ÏÇ¨Ïö© ÏãúÍ∞Ñ ÌëúÏãú ÏóÖÎç∞Ïù¥Ìä∏
        function updateUsageDisplay() {
            const totalTime = appSettings.totalUsageTime + appSettings.currentSessionTime;
            usageInfo.textContent = `${formatTime(totalTime)} ÏÇ¨Ïö© Ï§ë`;
            typingStatus.classList.toggle('active', isTyping);
        }

        // ÏûêÎèô Ï¥àÍ∏∞Ìôî ÌîåÎ†àÏù¥Ïä§ÌôÄÎçî ÏóÖÎç∞Ïù¥Ìä∏
        function updateAutoClearPlaceholder() {
            const baseText = "ÏïàÎìúÎ°úÏù¥ÎìúÏóêÏÑú ÌÖçÏä§Ìä∏ Ïó∞ÏäµÏùÑ ÏãúÏûëÌïòÏÑ∏Ïöî...";
            if (appSettings.autoClearTime > 0) {
                textEditor.placeholder = `${baseText}\n\n${appSettings.autoClearTime}Ï¥àÍ∞Ñ ÌÉÄÏù¥ÌïëÏùÑ Î©àÏ∂îÎ©¥ ÏûêÎèôÏúºÎ°ú Ï¥àÍ∏∞ÌôîÎê©ÎãàÎã§`;
            } else {
                textEditor.placeholder = baseText + "\n\nÏûêÎèô Ï¥àÍ∏∞ÌôîÍ∞Ä Ìï¥Ï†úÎêòÏóàÏäµÎãàÎã§";
            }
        }

        // ÏãúÍ∞Ñ Ìè¨Îß∑ÌåÖ
        function formatTime(seconds) {
            if (seconds < 60) return `${seconds}Ï¥à`;
            if (seconds < 3600) {
                const min = Math.floor(seconds / 60);
                const sec = seconds % 60;
                return sec === 0 ? `${min}Î∂Ñ` : `${min}Î∂Ñ ${sec}Ï¥à`;
            }
            const hour = Math.floor(seconds / 3600);
            const min = Math.floor((seconds % 3600) / 60);
            return min === 0 ? `${hour}ÏãúÍ∞Ñ` : `${hour}ÏãúÍ∞Ñ ${min}Î∂Ñ`;
        }

        // Ïù¥Î≤§Ìä∏ Î∞îÏù∏Îî©
        function bindEvents() {
            textEditor.addEventListener('input', onTextInput);
            textEditor.addEventListener('focus', onEditorFocus);
            textEditor.addEventListener('blur', onEditorBlur);
            
            // Î™®Îã¨ Î∞∞Í≤Ω ÌÅ¥Î¶≠ Ïãú Îã´Í∏∞
            document.querySelectorAll('.modal-overlay').forEach(modal => {
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.classList.remove('show');
                        setTimeout(() => modal.style.display = 'none', 200);
                    }
                });
            });
        }

        // ÌÖçÏä§Ìä∏ ÏûÖÎ†• Ï≤òÎ¶¨
        function onTextInput() {
            startTyping();
            resetAutoClearTimer();
        }

        // ÏóêÎîîÌÑ∞ Ìè¨Ïª§Ïä§
        function onEditorFocus() {
            resetAutoClearTimer();
        }

        // ÏóêÎîîÌÑ∞ Ìè¨Ïª§Ïä§ ÏûÉÏùå
        function onEditorBlur() {
            stopTyping();
            startAutoClearTimer();
        }

        // ÌÉÄÏù¥Ìïë ÏãúÏûë
        function startTyping() {
            if (!isTyping) {
                isTyping = true;
                updateUsageDisplay();
                hapticFeedback(10); // Í∞ÄÎ≤ºÏö¥ ÏßÑÎèô
            }
            lastKeyTime = Date.now();
        }

        // ÌÉÄÏù¥Ìïë Ï§ëÎã®
        function stopTyping() {
            if (isTyping) {
                isTyping = false;
                updateUsageDisplay();
                startAutoClearTimer();
            }
        }

        // ÏûêÎèô Ï¥àÍ∏∞Ìôî ÌÉÄÏù¥Î®∏ ÏãúÏûë
        function startAutoClearTimer() {
            if (appSettings.autoClearTime > 0 && textEditor.value.trim()) {
                autoClearTimer = setTimeout(() => {
                    clearText();
                    showAutoClearIndicator();
                }, appSettings.autoClearTime * 1000);
            }
        }

        // ÏûêÎèô Ï¥àÍ∏∞Ìôî ÌÉÄÏù¥Î®∏ Î¶¨ÏÖã
        function resetAutoClearTimer() {
            if (autoClearTimer) {
                clearTimeout(autoClearTimer);
                autoClearTimer = null;
            }
        }

        // ÏûêÎèô Ï¥àÍ∏∞Ìôî ÏïåÎ¶º ÌëúÏãú
        function showAutoClearIndicator() {
            autoClearIndicator.textContent = `${appSettings.autoClearTime}Ï¥à ÌõÑ ÏûêÎèô Ï¥àÍ∏∞ÌôîÎê®`;
            autoClearIndicator.classList.add('show');
            setTimeout(() => autoClearIndicator.classList.remove('show'), 2000);
        }

        // ÏÑ∏ÏÖò ÌÉÄÏù¥Î®∏
        function startSessionTimer() {
            sessionTimer = setInterval(() => {
                if (isTyping) {
                    appSettings.currentSessionTime++;
                    updateUsageDisplay();
                    saveSettings();
                }

                // 1Ï¥à Ïù¥ÏÉÅ ÏûÖÎ†•Ïù¥ ÏóÜÏúºÎ©¥ ÌÉÄÏù¥Ìïë ÏÉÅÌÉú Ìï¥Ï†ú
                if (isTyping && Date.now() - lastKeyTime > 1000) {
                    stopTyping();
                }
            }, 1000);
        }

        // ÌñÖÌã± ÌîºÎìúÎ∞±
        function hapticFeedback(duration = 50) {
            if (navigator.vibrate) {
                navigator.vibrate(duration);
            }
        }

        // ÌÖçÏä§Ìä∏ Ï¥àÍ∏∞Ìôî
        function clearText() {
            textEditor.value = '';
            textEditor.focus();
            stopTyping();
            resetAutoClearTimer();
            hapticFeedback(100);
            
            // ÏãúÍ∞ÅÏ†Å ÌîºÎìúÎ∞±
            textEditor.classList.add('vibrate');
            setTimeout(() => textEditor.classList.remove('vibrate'), 300);
        }

        // ÌÖçÏä§Ìä∏ Î≥µÏÇ¨
        async function copyText() {
            if (!textEditor.value.trim()) {
                hapticFeedback([50, 50, 50]); // ÏóêÎü¨ ÏßÑÎèô
                return;
            }
            
            try {
                await navigator.clipboard.writeText(textEditor.value);
                hapticFeedback(50);
                
                // ÏÑ±Í≥µ ÌîºÎìúÎ∞±
                const fab = document.querySelector('.fab.secondary');
                fab.style.background = 'linear-gradient(135deg, #4CAF50 0%, #45a049 100%)';
                setTimeout(() => {
                    fab.style.background = 'linear-gradient(135deg, #2196F3 0%, #1976D2 100%)';
                }, 500);
            } catch (e) {
                hapticFeedback([50, 50, 50]);
            }
        }

        // Ïï± Í≥µÏú†
        async function shareApp() {
            if (navigator.share) {
                try {
                    await navigator.share({
                        title: 'ÌÖçÏä§Ìä∏ Ïó∞Ïäµ Ïï±',
                        text: 'ÏïàÎìúÎ°úÏù¥ÎìúÏö© ÌÖçÏä§Ìä∏ Ïó∞Ïäµ Ïï±ÏùÑ ÏÇ¨Ïö©Ìï¥Î≥¥ÏÑ∏Ïöî!',
                        url: window.location.href
                    });
                } catch (e) {
                    console.log('Í≥µÏú† Ïã§Ìå®');
                }
            } else {
                // Í≥µÏú† APIÍ∞Ä ÏóÜÏúºÎ©¥ URL Î≥µÏÇ¨
                try {
                    await navigator.clipboard.writeText(window.location.href);
                    hapticFeedback(50);
                } catch (e) {
                    console.log('URL Î≥µÏÇ¨ Ïã§Ìå®');
                }
            }
        }

        // ÏÑ§Ï†ï Ìï®ÏàòÎì§
        function setFontSize(size) {
            appSettings.fontSize = size;
            updateUI();
            saveSettings();
            hapticFeedback(30);
        }

        function setAutoClearTime(seconds) {
            appSettings.autoClearTime = seconds;
            updateUI();
            saveSettings();
            resetAutoClearTimer();
            hapticFeedback(30);
        }

        function resetStats() {
            appSettings.totalUsageTime = 0;
            appSettings.currentSessionTime = 0;
            updateUsageDisplay();
            saveSettings();
            hapticFeedback(100);
            closeMenu();
        }

        // Î™®Îã¨ Í¥ÄÎ¶¨
        function showMenu() {
            document.getElementById('menuModal').style.display = 'flex';
            setTimeout(() => document.getElementById('menuModal').classList.add('show'), 10);
        }

        function closeMenu() {
            const modal = document.getElementById('menuModal');
            modal.classList.remove('show');
            setTimeout(() => modal.style.display = 'none', 200);
        }

        function showSettings() {
            closeMenu();
            setTimeout(() => {
                document.getElementById('settingsModal').style.display = 'flex';
                setTimeout(() => document.getElementById('settingsModal').classList.add('show'), 10);
            }, 200);
        }

        function closeSettings() {
            const modal = document.getElementById('settingsModal');
            modal.classList.remove('show');
            setTimeout(() => modal.style.display = 'none', 200);
        }

        // PWA ÏÑ§Ïπò
        function showInstallPrompt() {
            setTimeout(() => {
                installPrompt.style.display = 'flex';
            }, 3000); // 3Ï¥à ÌõÑ ÌëúÏãú
        }

        async function installApp() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                if (outcome === 'accepted') {
                    installPrompt.style.display = 'none';
                }
                deferredPrompt = null;
            }
        }

        // Îí§Î°úÍ∞ÄÍ∏∞ Î≤ÑÌäº Ï≤òÎ¶¨
        function handleBackButton(e) {
            const activeModal = document.querySelector('.modal-overlay.show');
            if (activeModal) {
                e.preventDefault();
                activeModal.classList.remove('show');
                setTimeout(() => activeModal.style.display = 'none', 200);
                return false;
            }
        }

        // ÌéòÏù¥ÏßÄ Ïñ∏Î°úÎìú Ïãú Ï¥ù ÏãúÍ∞Ñ Ï†ÄÏû•
        window.addEventListener('beforeunload', () => {
            appSettings.totalUsageTime += appSettings.currentSessionTime;
            appSettings.currentSessionTime = 0;
            saveSettings();
        });

        // Ïï± Ï¥àÍ∏∞Ìôî Ïã§Ìñâ
        initApp();
    </script>
</body>
</html>
