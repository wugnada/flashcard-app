<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>í”Œë˜ì‹œ ì¹´ë“œ ì—ë””í„°</title>
    
    <!-- PWA ë©”íƒ€ íƒœê·¸ -->
    <meta name="theme-color" content="#000000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="í”Œë˜ì‹œ ì¹´ë“œ">
    
    <!-- PWA ë§¤ë‹ˆí˜ìŠ¤íŠ¸ -->
    <link rel="manifest" href="data:application/json;base64,eyJuYW1lIjoi7ZSM656Y7Iqc7Lm07LWcIOyXkOuUlO2EsCIsInNob3J0X25hbWUiOiLtlIzrnpjsiqwiLCJzdGFydF91cmwiOiIuLyIsImRpc3BsYXkiOiJzdGFuZGFsb25lIiwiYmFja2dyb3VuZF9jb2xvciI6IiMwMDAwMDAiLCJ0aGVtZV9jb2xvciI6IiMwMDAwMDAiLCJpY29ucyI6W3sic3JjIjoiZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCxQSE4yWnlCM2FXUjBhRDBpTVRJNElpQm9aV2xuYUhROUlqRXlPQ0lpSUhacFpYZENiM2c5SWpBZ01DQXhNamdnTVRJNElpQm1hV3hzUFNJak1EQXdJaUIyWlhKemFXOXVQU0l4TGpFaUlHbGtQU0pqYkdscWRHRnRjbGt0YVdOdmJpSWdlRzFzYm5NOUltaDBkSEE2THk5M2QzY3Vkek11YjNKbkx6SXdNREF2YzNabklqNEtJQ0E4Y21WamRDQjNhV1IwYUQwaU1USTRMREF3SWlCb1pXbG5hSFE5SWpJMUlpQnllRDBpTXlJZ1ptbHNiRDBpSXpreFJVVTVNQ0l2UGdvZ0lEeDBaWGgwSUhnOUlqWTBJaUI1UFNJeE9DSWdabWxzYkQwaUl6a3dSVVU1TUNJZ2JXRjRMV2RzZVhCb2N6MGdMelE5SWo0Z01EWTFNREF4UEM5MFpYaDBQZ29nSUR4a1pXWnpQZ29nSUNBZ1BFeGJibVZoY2xkcFpIUm9QU0l3TGpjaUlHeGJibVZoY2toMWRXVTlJaTVzSWlCeVBTSTFJaUIzYVdSMGFEMGlNUzR5SWlCb1pXbG5hSFE5SWpFeUlpQm1hV3hzUFNJbE1EQXdJaUIyYVdWM1FtOTRQU0l3SURFZ05TQXlMamt4TlVrL1BpQWpPREU4TDJ4cGJtVmhja2R5WVdScFpXNTBQZ29nSUNBZ1BHeGJibVZoY2xkcFpIUm9QU0l3TGpjaUlHeGJibVZoY2toMWRXVTlJaTV0SWlCeVBTSTFJaUIzYVdSMGFEMGlNUzR5SWlCb1pXbG5hSFE5SWpFeUlpQm1hV3hzUFNJbE1EQXdJaUIyYVdWM1FtOTRQU0l3SURFZ05TQXlMamt4TlVrL1BpQWpOemc0UEM5c2FXNWxZWEpIY21Ga2FXVnVkRDRLSUNBOEwyUmxabk0rQ2lBZ1BIVnpaU0IzYVdSMGFEMGlNVEk0SWlCb1pXbG5hSFE5SWpFeU9DSWdhSEpsWmpBaVl5QWlJaUI0YkdsdWF6cHNhVzVsWVhKSGNtRmthV1Z1ZEMwdE16SWlMejRLUEM5emRtYysaIiwic2l6ZXMiOiIxMjh4MTI4IiwidHlwZSI6ImltYWdlL3N2Zyt4bWwifSx7InNyYyI6ImRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5QjNhV1IwYUQwaU5URXlJaUJvWldsbmFIUTlJalV4TWlJZ2RtbGxkMEp2ZUQwaU1DQXdJRFV4TWlBMU1USWlJR1pwYkc5OUlpTXdNREF3TXlJZ2RtVnljMmx2YmowaU1TNHhJaUJwWkQwaVkyeHBhM1JoYlhOc2VTMXBZMjl1SWlCNGJXeHVjejBpYUhSMGNEb3ZMM2QzZHk1M015NXZjbWN2TWpBd01DOXpkbWNpUGdvZ0lEeHlaV04wSUhkcFpIUm9QU0kxTVRJdU1EQXdJaUJvWldsbmFIUTlJakV5TlNJZ2NuZzlJakV1TlNJZ1ptbHNiRDBpSXpreFJVVTVNQ0l2UGdvZ0lEeDBaWGgwSUhnOUlqRXlPQ0lnZVQwaU5USWlJR1pwYkc5OUlpTTVNRVZGT1RBaUlHMWhlQzEwWlhoMExXZHNlWEJvY3owanR6MHNMejQ5SW1sa1BUa2lQaTVzbWQ4eFhEPGRpKHlpdnFoZHVuLaVIYWxhU0Vzai9lVGdvZ0lEeGtaV1p6UGdvZ0lDQWdQSHgwYnlCM2FXUjBhRDBpTUM0M0lpQjNhR3gyWVdSMGFEMGlMaUVpSUhJOUlqVWlJSGRwWkhSb1BTSTJjeUlnYUdWcFoyaDBQU0k0SWlCbWFXeHNQU0lsTURBd0lpQjJhV1YzUW05NFBTSXdJREVnTkNBeElERXBMejRnWm10ZmIzSjBQQ05hYXFCeWJFOWJkSFI2SUc5cmEybFA9IiwIc2l6ZXMiOiI1MTJ4NTEyIiwidHlwZSI6ImltYWdlL3N2Zyt4bWwifV0sImNhdGVnb3JpZXMiOlsicHJvZHVjdGl2aXR5IiwiZWR1Y2F0aW9uIl0sImxhbmdJc28iOiJrbyJ9">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            /* ì•ˆë“œë¡œì´ë“œ ì‹œìŠ¤í…œ í°íŠ¸ ìš°ì„  + ì˜ì–´ëŠ” ëª¨ë˜ í°íŠ¸ */
            font-family: 
                system-ui, -apple-system, BlinkMacSystemFont, 'Roboto', 'Noto Sans KR', 'Malgun Gothic',
                'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 
                'Liberation Mono', Menlo, Courier, sans-serif, monospace;
            background-color: #000;
            color: #90EE90;
            height: 100vh;
            overflow: hidden;
            user-select: none;
            -webkit-user-select: none;
            -webkit-touch-callout: none;
            display: flex;
            flex-direction: column;
            position: fixed;
            width: 100%;
            top: 0;
            left: 0;
            /* ì•ˆë“œë¡œì´ë“œ ìµœì í™” */
            -webkit-font-smoothing: antialiased;
            text-rendering: optimizeLegibility;
        }

        .mobile-header {
            background: linear-gradient(135deg, #111, #222);
            border-bottom: 2px solid #333;
            padding: 10px 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            min-height: 60px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.5);
        }

        .app-title {
            color: #90EE90;
            font-size: 18px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .header-actions {
            display: flex;
            gap: 10px;
        }

        .header-btn {
            background: none;
            border: 1px solid #555;
            color: #90EE90;
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .header-btn:active {
            background-color: #333;
            transform: scale(0.95);
        }

        .stats-bar {
            background-color: #111;
            border-bottom: 1px solid #333;
            padding: 8px 15px;
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            min-height: 40px;
        }

        .usage-stats {
            color: #90EE90;
        }

        .auto-clear-status {
            color: #FF6B6B;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .auto-clear-status.active {
            opacity: 1;
        }

        .editor-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 0;
            background-color: #000;
        }

        .text-editor {
            flex: 1;
            width: 100%;
            background-color: #000;
            color: #90EE90;
            border: none;
            outline: none;
            /* ì•ˆë“œë¡œì´ë“œ ì‹œìŠ¤í…œ í°íŠ¸ ìš°ì„  + ì˜ì–´ëŠ” ëª¨ë˜ í°íŠ¸ */
            font-family: 
                system-ui, -apple-system, BlinkMacSystemFont, 'Roboto', 'Noto Sans KR', 'Malgun Gothic',
                'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 
                'Liberation Mono', Menlo, Courier, sans-serif, monospace;
            font-size: 20px;
            padding: 20px;
            resize: none;
            line-height: 1.5;
            user-select: text;
            -webkit-user-select: text;
            text-align: center;
        }

        .text-editor::placeholder {
            color: #666;
            text-align: center;
        }

        .bottom-toolbar {
            background: linear-gradient(135deg, #111, #222);
            border-top: 2px solid #333;
            padding: 15px;
            display: flex;
            justify-content: space-around;
            align-items: center;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.5);
        }

        .toolbar-btn {
            background: linear-gradient(135deg, #333, #444);
            border: 1px solid #555;
            color: #90EE90;
            padding: 12px 16px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.2s ease;
            min-width: 120px;
            justify-content: center;
        }

        .toolbar-btn:active {
            background: linear-gradient(135deg, #555, #666);
            transform: scale(0.95);
        }

        .floating-action-btn {
            position: fixed;
            bottom: 110px;
            right: 20px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #333, #444);
            border: 1px solid #555;
            border-radius: 50%;
            color: #90EE90;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(0,0,0,0.4);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .floating-action-btn:active {
            transform: scale(0.9);
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            display: none;
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-content {
            background: linear-gradient(135deg, #111, #222);
            border: 2px solid #333;
            border-radius: 15px;
            padding: 25px;
            max-width: 90%;
            min-width: 280px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.7);
        }

        .modal-title {
            color: #90EE90;
            font-size: 18px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: bold;
        }

        .modal-input {
            width: 100%;
            padding: 12px;
            background-color: #000;
            color: #90EE90;
            border: 2px solid #555;
            border-radius: 8px;
            font-family: inherit;
            font-size: 16px;
            margin-bottom: 20px;
            text-align: center;
        }

        .modal-input:focus {
            border-color: #90EE90;
            outline: none;
        }

        .modal-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .modal-btn {
            padding: 12px 25px;
            background: linear-gradient(135deg, #333, #444);
            color: #90EE90;
            border: 1px solid #555;
            border-radius: 8px;
            cursor: pointer;
            font-family: inherit;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.2s ease;
        }

        .modal-btn:active {
            background: linear-gradient(135deg, #555, #666);
            transform: scale(0.95);
        }

        .modal-btn.primary {
            background: linear-gradient(135deg, #0d4f3c, #0e5d47);
            border-color: #90EE90;
        }

        .settings-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background-color: #222;
            border-radius: 8px;
            border: 1px solid #333;
        }

        .setting-label {
            color: #90EE90;
            font-size: 14px;
        }

        .setting-value {
            color: #FFD700;
            font-size: 12px;
            background-color: #333;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
        }

        .quick-actions {
            position: fixed;
            bottom: 180px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            opacity: 0;
            transform: translateX(100px);
            transition: all 0.3s ease;
            z-index: 999;
        }

        .quick-actions.active {
            opacity: 1;
            transform: translateX(0);
        }

        .quick-action-btn {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #333, #444);
            border: 1px solid #555;
            border-radius: 50%;
            color: #90EE90;
            font-size: 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        }

        .quick-action-btn:active {
            transform: scale(0.9);
            background: linear-gradient(135deg, #555, #666);
        }

        .battery-saver {
            position: fixed;
            top: 50px;
            right: 15px;
            background: rgba(255, 193, 7, 0.9);
            color: #000;
            padding: 8px 12px;
            border-radius: 16px;
            font-size: 12px;
            font-weight: bold;
            display: none;
            z-index: 1000;
        }

        .connection-status {
            position: fixed;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.8);
            color: #90EE90;
            padding: 6px 12px;
            border-radius: 12px;
            font-size: 11px;
            display: none;
            z-index: 1000;
            border: 1px solid #333;
        }

        .connection-status.offline {
            color: #FF6B6B;
            border-color: #FF6B6B;
        }

        .android-toast {
            position: fixed;
            bottom: 50%;
            left: 50%;
            transform: translate(-50%, 50%);
            background-color: #323232;
            color: white;
            padding: 12px 24px;
            border-radius: 24px;
            font-size: 14px;
            z-index: 3000;
            opacity: 0;
            transition: opacity 0.3s ease;
            box-shadow: 0 4px 12px rgba(0,0,0,0.4);
        }

        .android-toast.show {
            opacity: 1;
        }

        /* ì•ˆë“œë¡œì´ë“œ í‚¤ë³´ë“œ ëŒ€ì‘ ê°œì„  */
        @media screen and (max-height: 500px) {
            .stats-bar {
                display: none;
            }
            .floating-action-btn {
                bottom: 20px;
                right: 15px;
                width: 50px;
                height: 50px;
            }
            .bottom-toolbar {
                padding: 8px 10px;
            }
            .toolbar-btn {
                padding: 10px 12px;
                font-size: 12px;
                min-width: 80px;
            }
        }

        /* ë¨¸í„°ë¦¬ì–¼ ë””ìì¸ ripple íš¨ê³¼ */
        .ripple {
            position: relative;
            overflow: hidden;
        }

        .ripple::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255,255,255,0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .ripple:active::before {
            width: 300px;
            height: 300px;
        }

        /* ì§„ë™ ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .shake {
            animation: shake 0.5s ease-in-out;
        }
    </style>
</head>
<body>
    <!-- ë©”ì¸ í—¤ë” -->
    <div class="mobile-header">
        <div class="app-title">
            ğŸ“ í”Œë˜ì‹œ ì¹´ë“œ
        </div>
        <div class="header-actions">
            <button class="header-btn" onclick="toggleSettings()" title="ì„¤ì •">âš™ï¸</button>
        </div>
    </div>

    <!-- í†µê³„ ë°” -->
    <div class="stats-bar">
        <div class="usage-stats" id="usageStats">
            <span id="sessionTime">0ì´ˆ</span> | 
            ì´ <span id="totalTime">0ì´ˆ</span>
        </div>
        <div class="auto-clear-status" id="autoClearStatus">5ì´ˆ í›„ ìë™ ì´ˆê¸°í™”</div>
    </div>

    <!-- ì—ë””í„° ì˜ì—­ -->
    <div class="editor-container">
        <textarea 
            class="text-editor" 
            id="textEditor" 
            placeholder="ì—¬ê¸°ì— í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”..."
            spellcheck="false"
        ></textarea>
    </div>

    <!-- í•˜ë‹¨ íˆ´ë°” -->
    <div class="bottom-toolbar">
        <button class="toolbar-btn ripple" onclick="showFontSettings()">
            ğŸ”¤ í°íŠ¸ í¬ê¸°
        </button>
        <button class="toolbar-btn ripple" onclick="showTimeSettings()">
            â° ìë™ ì´ˆê¸°í™”
        </button>
    </div>

    <!-- í”Œë¡œíŒ… ì•¡ì…˜ ë²„íŠ¼ -->
    <button class="floating-action-btn ripple" onclick="toggleQuickActions()" title="ë¹ ë¥¸ ì‘ì—…">
        âš™ï¸
    </button>

    <!-- ë¹ ë¥¸ ì‘ì—… ë©”ë‰´ -->
    <div class="quick-actions" id="quickActions">
        <button class="quick-action-btn ripple" onclick="resetText()" title="ì´ˆê¸°í™”">ğŸ—‘ï¸</button>
        <button class="quick-action-btn ripple" onclick="focusEditor()" title="í¬ì»¤ìŠ¤">ğŸ“</button>
        <button class="quick-action-btn ripple" onclick="toggleFullscreen()" title="í™”ë©´ìµœì í™”">ğŸ”</button>
        <button class="quick-action-btn ripple" onclick="quickSettings()" title="ë¹ ë¥¸ì„¤ì •">âš™ï¸</button>
    </div>

    <!-- ë°°í„°ë¦¬ ì ˆì•½ ëª¨ë“œ í‘œì‹œ -->
    <div class="battery-saver" id="batterySaver">
        ğŸ”‹ ë°°í„°ë¦¬ ì ˆì•½ ëª¨ë“œ
    </div>

    <!-- ì—°ê²° ìƒíƒœ í‘œì‹œ -->
    <div class="connection-status" id="connectionStatus">
        ğŸŒ ì˜¤í”„ë¼ì¸ ëª¨ë“œ
    </div>

    <!-- ì•ˆë“œë¡œì´ë“œ í† ìŠ¤íŠ¸ -->
    <div class="android-toast" id="androidToast"></div>

    <!-- ì„¤ì • ëª¨ë‹¬ -->
    <div class="modal" id="settingsModal">
        <div class="modal-content">
            <div class="modal-title">âš™ï¸ ì„¤ì •</div>
            <div class="settings-list">
                <div class="setting-item">
                    <span class="setting-label">í°íŠ¸ í¬ê¸°</span>
                    <span class="setting-value" onclick="showFontSettings()" id="fontSizeDisplay">20px</span>
                </div>
                <div class="setting-item">
                    <span class="setting-label">ìë™ ì´ˆê¸°í™”</span>
                    <span class="setting-value" onclick="showTimeSettings()" id="autoClearDisplay">5ì´ˆ</span>
                </div>
                <div class="setting-item">
                    <span class="setting-label">ì§„ë™ í”¼ë“œë°±</span>
                    <span class="setting-value" onclick="toggleVibration()" id="vibrationDisplay">ON</span>
                </div>
                <div class="setting-item">
                    <span class="setting-label">ìŠ¤ë§ˆíŠ¸ ì§„ë™</span>
                    <span class="setting-value" onclick="toggleSmartVibration()" id="smartVibrationDisplay">ON</span>
                </div>
                <div class="setting-item">
                    <span class="setting-label">í™”ë©´ ìµœì í™”</span>
                    <span class="setting-value" onclick="toggleFullscreen(); closeSettings();" id="fullscreenDisplay">ì „í™˜</span>
                </div>
                <div class="setting-item">
                    <span class="setting-label">í˜„ì¬ ì„¸ì…˜</span>
                    <span class="setting-value" onclick="resetSessionTime()" id="sessionTimeDisplay">ì´ˆê¸°í™”</span>
                </div>
                <div class="setting-item">
                    <span class="setting-label">ì´ ì‚¬ìš© ì‹œê°„</span>
                    <span class="setting-value" onclick="resetTotalTime()" id="totalTimeDisplay">ì´ˆê¸°í™”</span>
                </div>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn" onclick="closeSettings()">ë‹«ê¸°</button>
            </div>
        </div>
    </div>

    <!-- í°íŠ¸ í¬ê¸° ëª¨ë‹¬ -->
    <div class="modal" id="fontModal">
        <div class="modal-content">
            <div class="modal-title">ğŸ”¤ í°íŠ¸ í¬ê¸° ì„¤ì •</div>
            <div style="color: #90EE90; margin-bottom: 15px; text-align: center;">
                í˜„ì¬: <span id="currentFontSize">20px</span>
            </div>
            <input type="range" 
                   id="fontSizeSlider" 
                   min="12" 
                   max="36" 
                   value="20" 
                   style="width: 100%; margin-bottom: 20px;">
            <div class="modal-buttons">
                <button class="modal-btn primary" onclick="applyFontSize()">ì ìš©</button>
                <button class="modal-btn" onclick="closeFontModal()">ì·¨ì†Œ</button>
            </div>
        </div>
    </div>

    <!-- ìë™ ì´ˆê¸°í™” ì‹œê°„ ëª¨ë‹¬ -->
    <div class="modal" id="timeModal">
        <div class="modal-content">
            <div class="modal-title">â° ìë™ ì´ˆê¸°í™” ì„¤ì •</div>
            <div style="color: #90EE90; margin-bottom: 15px; text-align: center;">
                í˜„ì¬: <span id="currentAutoTime">5ì´ˆ</span>
            </div>
            <input type="range" 
                   id="autoTimeSlider" 
                   min="0" 
                   max="60" 
                   step="5" 
                   value="5" 
                   style="width: 100%; margin-bottom: 20px;">
            <div style="color: #FFD700; font-size: 12px; text-align: center; margin-bottom: 15px;">
                0 = í•´ì œ, 5-60ì´ˆ ì„¤ì • ê°€ëŠ¥
            </div>
            <div class="modal-buttons">
                <button class="modal-btn primary" onclick="applyAutoTime()">ì ìš©</button>
                <button class="modal-btn" onclick="closeTimeModal()">ì·¨ì†Œ</button>
            </div>
        </div>
    </div>

    <script>
        // PWA ê´€ë ¨ ë³€ìˆ˜
        let deferredPrompt;
        let isInstalled = false;
        let isQuickActionsOpen = false;
        let isFullscreen = false;

        // ì• í”Œë¦¬ì¼€ì´ì…˜ ì„¤ì •
        let settings = {
            fontSize: 20,
            autoClearTime: 5,
            vibrationEnabled: true,
            sessionTime: 0,
            totalTime: 0,
            batterySaver: false,
            smartVibration: true
        };

        // ìƒíƒœ ë³€ìˆ˜
        let isTyping = false;
        let lastTypingTime = 0;
        let sessionTimer = null;
        let autoClearTimer = null;
        let shakeThreshold = 15;
        let lastShakeTime = 0;

        // DOM ìš”ì†Œ
        const textEditor = document.getElementById('textEditor');
        const sessionTimeElement = document.getElementById('sessionTime');
        const totalTimeElement = document.getElementById('totalTime');
        const autoClearStatus = document.getElementById('autoClearStatus');

        // ì´ˆê¸°í™”
        function init() {
            loadSettings();
            updateUI();
            startSessionTimer();
            initShakeDetection();
            initPWA();
            bindEvents();
            updateUsagePattern();
            initAndroidFeatures();
        }

        // ì•ˆë“œë¡œì´ë“œ íŠ¹í™” ê¸°ëŠ¥ ì´ˆê¸°í™”
        function initAndroidFeatures() {
            initBackButtonHandler();
            initKeyboardDetection();
            initBatteryMonitoring();
            initConnectionMonitoring();
            setupAndroidVibration();
            initFullscreenMode();
        }

        // ë’¤ë¡œê°€ê¸° ë²„íŠ¼ ì²˜ë¦¬
        function initBackButtonHandler() {
            let modalStack = [];
            
            const addToModalStack = (modalId) => {
                modalStack.push(modalId);
                history.pushState({ modal: modalId }, '', '');
            };
            
            window.addEventListener('popstate', (e) => {
                if (modalStack.length > 0) {
                    const modalId = modalStack.pop();
                    document.getElementById(modalId).style.display = 'none';
                } else if (isQuickActionsOpen) {
                    toggleQuickActions();
                } else {
                    if (confirm('ì•±ì„ ì¢…ë£Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                        window.close();
                    } else {
                        history.pushState(null, '', '');
                    }
                }
            });
            
            history.pushState(null, '', '');
            
            window.originalToggleSettings = toggleSettings;
            toggleSettings = () => {
                originalToggleSettings();
                addToModalStack('settingsModal');
            };
        }

        // í‚¤ë³´ë“œ ë†’ì´ ê°ì§€
        function initKeyboardDetection() {
            const viewport = window.visualViewport;
            if (viewport) {
                viewport.addEventListener('resize', () => {
                    const keyboardHeight = window.innerHeight - viewport.height;
                    if (keyboardHeight > 100) {
                        document.querySelector('.bottom-toolbar').style.transform = `translateY(-${keyboardHeight}px)`;
                        document.querySelector('.floating-action-btn').style.transform = `translateY(-${keyboardHeight}px)`;
                    } else {
                        document.querySelector('.bottom-toolbar').style.transform = '';
                        document.querySelector('.floating-action-btn').style.transform = '';
                    }
                });
            }
        }

        // ë°°í„°ë¦¬ ìƒíƒœ ê°ì§€
        function initBatteryMonitoring() {
            if ('getBattery' in navigator) {
                navigator.getBattery().then((battery) => {
                    const updateBatteryStatus = () => {
                        if (battery.level < 0.2 && !battery.charging) {
                            settings.batterySaver = true;
                            document.getElementById('batterySaver').style.display = 'block';
                            settings.vibrationEnabled = false;
                        } else if (battery.level > 0.3 || battery.charging) {
                            settings.batterySaver = false;
                            document.getElementById('batterySaver').style.display = 'none';
                            settings.vibrationEnabled = true;
                        }
                    };
                    
                    battery.addEventListener('levelchange', updateBatteryStatus);
                    battery.addEventListener('chargingchange', updateBatteryStatus);
                    updateBatteryStatus();
                });
            }
        }

        // ì—°ê²° ìƒíƒœ ê°ì§€
        function initConnectionMonitoring() {
            const updateConnectionStatus = () => {
                const status = document.getElementById('connectionStatus');
                if (navigator.onLine) {
                    status.style.display = 'none';
                } else {
                    status.style.display = 'block';
                    status.className = 'connection-status offline';
                    status.textContent = 'ğŸ”´ ì˜¤í”„ë¼ì¸ ëª¨ë“œ';
                    showAndroidToast('ì˜¤í”„ë¼ì¸ ìƒíƒœì…ë‹ˆë‹¤');
                }
            };
            
            window.addEventListener('online', updateConnectionStatus);
            window.addEventListener('offline', updateConnectionStatus);
            updateConnectionStatus();
        }

        // ì•ˆë“œë¡œì´ë“œ ì§„ë™ íŒ¨í„´ ì„¤ì •
        function setupAndroidVibration() {
            window.androidVibrate = (pattern) => {
                if (settings.vibrationEnabled && navigator.vibrate) {
                    if (settings.smartVibration) {
                        const hour = new Date().getHours();
                        if (hour >= 22 || hour <= 7) {
                            if (Array.isArray(pattern)) {
                                pattern = pattern.map(p => Math.floor(p * 0.5));
                            } else {
                                pattern = Math.floor(pattern * 0.5);
                            }
                        }
                    }
                    navigator.vibrate(pattern);
                }
            };
        }

        // ì „ì²´í™”ë©´ ëª¨ë“œ ì´ˆê¸°í™”
        function initFullscreenMode() {
            document.addEventListener('touchmove', (e) => {
                if (e.target === document.body) {
                    e.preventDefault();
                }
            }, { passive: false });
        }

        // ì „ì²´í™”ë©´ ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateFullscreenButton() {
            const fullscreenBtn = document.querySelector('.quick-action-btn[onclick="toggleFullscreen()"]');
            if (fullscreenBtn) {
                fullscreenBtn.textContent = isFullscreen ? 'ğŸ”' : 'ğŸ”';
                fullscreenBtn.title = isFullscreen ? 'í™”ë©´ìµœì í™” í•´ì œ' : 'í™”ë©´ìµœì í™”';
            }
        }

        // PWA ì´ˆê¸°í™”
        function initPWA() {
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('data:text/javascript;base64,c2VsZi5hZGRFdmVudExpc3RlbmVyKCdpbnN0YWxsJywgZXZlbnQgPT4gewogIGV2ZW50LndhaXRVbnRpbChzZWxmLnNraXBXYWl0aW5nKCkpOwp9KTsKCnNlbGYuYWRkRXZlbnRMaXN0ZW5lcignYWN0aXZhdGUnLCBldmVudCA9PiB7CiAgZXZlbnQud2FpdFVudGlsKHNlbGYuY2xpZW50cy5jbGFpbSgpKTsKfSk7Cgpjb25zdCBDQUNIRV9OQU1FID0gJ3RleHQtZWRpdG9yLXYxJzsKY29uc3QgdXJsc1RvQ2FjaGUgPSBbCiAgJy4vJywKICAnLi9pbmRleC5odG1sJwpdOwoKc2VsZi5hZGRFdmVudExpc3RlbmVyKCdpbnN0YWxsJywgZXZlbnQgPT4gewogIGV2ZW50LndhaXRVbnRpbCgKICAgIGNhY2hlcy5vcGVuKENBQ0hFX05BTUUpCiAgICAgIC50aGVuKGNhY2hlID0+IGNhY2hlLmFkZEFsbCh1cmxzVG9DYWNoZSkpCiAgKTsKfSk7CgpzZWxmLmFkZEV2ZW50TGlzdGVuZXIoJ2ZldGNoJywgZXZlbnQgPT4gewogIGV2ZW50LnJlc3BvbmRXaXRoKAogICAgY2FjaGVzLm1hdGNoKGV2ZW50LnJlcXVlc3QpCiAgICAgIC50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICBpZiAocmVzcG9uc2UpIHsKICAgICAgICAgIHJldHVybiByZXNwb25zZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZldGNoKGV2ZW50LnJlcXVlc3QpOwogICAgICB9KQogICk7Cn0pOw==')
                    .then(() => console.log('Service Worker ë“±ë¡ë¨'))
                    .catch(err => console.log('Service Worker ë“±ë¡ ì‹¤íŒ¨', err));
            }

            window.addEventListener('beforeinstallprompt', (e) => {
                e.preventDefault();
                deferredPrompt = e;
            });

            window.addEventListener('appinstalled', () => {
                isInstalled = true;
            });
        }

        // ì„¤ì • ë¡œë“œ
        function loadSettings() {
            const saved = localStorage.getItem('flashCardSettings');
            if (saved) {
                settings = { ...settings, ...JSON.parse(saved) };
            }

            const today = new Date().toDateString();
            const totalTimeData = localStorage.getItem('flashCardTotalTime');
            if (totalTimeData) {
                const data = JSON.parse(totalTimeData);
                settings.totalTime = data[today] || 0;
            }
        }

        // ì„¤ì • ì €ì¥
        function saveSettings() {
            localStorage.setItem('flashCardSettings', JSON.stringify(settings));
            
            const today = new Date().toDateString();
            let totalTimeData = {};
            const saved = localStorage.getItem('flashCardTotalTime');
            if (saved) {
                totalTimeData = JSON.parse(saved);
            }
            totalTimeData[today] = settings.totalTime;
            localStorage.setItem('flashCardTotalTime', JSON.stringify(totalTimeData));
        }

        // UI ì—…ë°ì´íŠ¸
        function updateUI() {
            textEditor.style.fontSize = settings.fontSize + 'px';
            updateTimeDisplay();
            updatePlaceholder();
            updateSettingsDisplay();
        }

        // ì‹œê°„ í‘œì‹œ ì—…ë°ì´íŠ¸
        function updateTimeDisplay() {
            sessionTimeElement.textContent = formatTime(settings.sessionTime);
            totalTimeElement.textContent = formatTime(settings.totalTime);
            
            if (isTyping) {
                sessionTimeElement.textContent += ' âŒ¨ï¸';
            }
        }

        // placeholder ì—…ë°ì´íŠ¸
        function updatePlaceholder() {
            if (settings.autoClearTime > 0) {
                textEditor.placeholder = `ì—¬ê¸°ì— í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”...\n(${settings.autoClearTime}ì´ˆ í›„ ìë™ ì´ˆê¸°í™”)`;
            } else {
                textEditor.placeholder = 'ì—¬ê¸°ì— í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”...\n(ìë™ ì´ˆê¸°í™” í•´ì œ)';
            }
        }

        // ì„¤ì • í‘œì‹œ ì—…ë°ì´íŠ¸
        function updateSettingsDisplay() {
            document.getElementById('fontSizeDisplay').textContent = settings.fontSize + 'px';
            document.getElementById('autoClearDisplay').textContent = 
                settings.autoClearTime === 0 ? 'í•´ì œ' : settings.autoClearTime + 'ì´ˆ';
            document.getElementById('vibrationDisplay').textContent = 
                settings.vibrationEnabled ? 'ON' : 'OFF';
            document.getElementById('smartVibrationDisplay').textContent = 
                settings.smartVibration ? 'ON' : 'OFF';
            document.getElementById('fullscreenDisplay').textContent = 
                isFullscreen ? 'í•´ì œ' : 'ì „í™˜';
        }

        // ì‹œê°„ í¬ë§·íŒ…
        function formatTime(seconds) {
            if (seconds < 60) return seconds + 'ì´ˆ';
            if (seconds < 3600) {
                const minutes = Math.floor(seconds / 60);
                const remainingSeconds = seconds % 60;
                return remainingSeconds === 0 ? `${minutes}ë¶„` : `${minutes}ë¶„ ${remainingSeconds}ì´ˆ`;
            }
            const hours = Math.floor(seconds / 3600);
            const minutes = Math.floor((seconds % 3600) / 60);
            return minutes === 0 ? `${hours}ì‹œê°„` : `${hours}ì‹œê°„ ${minutes}ë¶„`;
        }

        // ì´ë²¤íŠ¸ ë°”ì¸ë”©
        function bindEvents() {
            textEditor.addEventListener('input', onTextInput);
            textEditor.addEventListener('focus', onEditorFocus);
            textEditor.addEventListener('blur', onEditorBlur);

            document.addEventListener('click', (e) => {
                if (e.target.classList.contains('modal')) {
                    closeAllModals();
                }
            });

            window.addEventListener('popstate', () => {
                closeAllModals();
            });

            document.getElementById('fontSizeSlider').addEventListener('input', (e) => {
                document.getElementById('currentFontSize').textContent = e.target.value + 'px';
            });
            
            document.getElementById('autoTimeSlider').addEventListener('input', (e) => {
                const value = parseInt(e.target.value);
                document.getElementById('currentAutoTime').textContent = 
                    value === 0 ? 'í•´ì œ' : value + 'ì´ˆ';
            });
        }

        // í…ìŠ¤íŠ¸ ì…ë ¥ ì‹œ
        function onTextInput() {
            startTyping();
            resetAutoClearTimer();
        }

        // ì—ë””í„° í¬ì»¤ìŠ¤
        function onEditorFocus() {
            resetAutoClearTimer();
        }

        // ì—ë””í„° í¬ì»¤ìŠ¤ í•´ì œ
        function onEditorBlur() {
            if (settings.autoClearTime > 0 && textEditor.value.trim()) {
                startAutoClearTimer();
            }
        }

        // íƒ€ì´í•‘ ì‹œì‘
        function startTyping() {
            if (!isTyping) {
                isTyping = true;
                updateTimeDisplay();
            }
            lastTypingTime = Date.now();
        }

        // íƒ€ì´í•‘ ì¤‘ë‹¨ í™•ì¸
        function checkTypingStop() {
            if (isTyping && Date.now() - lastTypingTime > 1000) {
                isTyping = false;
                updateTimeDisplay();
                if (settings.autoClearTime > 0 && textEditor.value.trim()) {
                    startAutoClearTimer();
                }
            }
        }

        // ìë™ ì´ˆê¸°í™” íƒ€ì´ë¨¸ ì‹œì‘
        function startAutoClearTimer() {
            resetAutoClearTimer();
            if (settings.autoClearTime > 0) {
                autoClearStatus.classList.add('active');
                autoClearTimer = setTimeout(() => {
                    resetText();
                    autoClearStatus.classList.remove('active');
                }, settings.autoClearTime * 1000);
            }
        }

        // ìë™ ì´ˆê¸°í™” íƒ€ì´ë¨¸ ë¦¬ì…‹
        function resetAutoClearTimer() {
            if (autoClearTimer) {
                clearTimeout(autoClearTimer);
                autoClearTimer = null;
            }
            autoClearStatus.classList.remove('active');
        }

        // ì„¸ì…˜ íƒ€ì´ë¨¸ ì‹œì‘
        function startSessionTimer() {
            sessionTimer = setInterval(() => {
                if (isTyping) {
                    settings.sessionTime++;
                    settings.totalTime++;
                    updateTimeDisplay();
                    saveSettings();
                }
                checkTypingStop();
            }, 1000);
        }

        // í”ë“¤ê¸° ê°ì§€ ì´ˆê¸°í™”
        function initShakeDetection() {
            if (typeof DeviceMotionEvent !== 'undefined') {
                if (typeof DeviceMotionEvent.requestPermission === 'function') {
                    textEditor.addEventListener('touchstart', requestMotionPermission, { once: true });
                } else {
                    startShakeDetection();
                }
            }
        }

        // ëª¨ì…˜ ê¶Œí•œ ìš”ì²­
        function requestMotionPermission() {
            if (typeof DeviceMotionEvent.requestPermission === 'function') {
                DeviceMotionEvent.requestPermission()
                    .then(permissionState => {
                        if (permissionState === 'granted') {
                            startShakeDetection();
                        }
                    })
                    .catch(console.error);
            }
        }

        // í”ë“¤ê¸° ê°ì§€ ì‹œì‘
        function startShakeDetection() {
            let lastX = 0, lastY = 0, lastZ = 0;
            
            window.addEventListener('devicemotion', (event) => {
                const acceleration = event.accelerationIncludingGravity;
                if (!acceleration) return;
                
                const { x = 0, y = 0, z = 0 } = acceleration;
                const deltaX = Math.abs(x - lastX);
                const deltaY = Math.abs(y - lastY);
                const deltaZ = Math.abs(z - lastZ);
                const totalDelta = deltaX + deltaY + deltaZ;
                
                if (totalDelta > shakeThreshold && Date.now() - lastShakeTime > 1000) {
                    onShakeDetected();
                    lastShakeTime = Date.now();
                }
                
                lastX = x;
                lastY = y;
                lastZ = z;
            });
        }

        // í”ë“¤ê¸° ê°ì§€ ì‹œ ì‹¤í–‰ (ì•ˆë“œë¡œì´ë“œ ìµœì í™”)
        function onShakeDetected() {
            if (textEditor.value.trim()) {
                if (confirm('í…ìŠ¤íŠ¸ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    resetText();
                    androidVibrate([200, 100, 200, 100, 200]);
                    document.body.classList.add('shake');
                    setTimeout(() => document.body.classList.remove('shake'), 500);
                    showAndroidToast('í”ë“¤ì–´ì„œ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤!');
                }
            }
        }

        // ì‚¬ìš© íŒ¨í„´ ì—…ë°ì´íŠ¸
        function updateUsagePattern() {
            const now = new Date();
            const today = now.toDateString();
            const hour = now.getHours();
            
            let patterns = {};
            const saved = localStorage.getItem('flashCardUsagePatterns');
            if (saved) {
                patterns = JSON.parse(saved);
            }
            
            if (!patterns[today]) {
                patterns[today] = {};
            }
            
            patterns[today][hour] = (patterns[today][hour] || 0) + 1;
            localStorage.setItem('flashCardUsagePatterns', JSON.stringify(patterns));
        }

        // ì•ˆë“œë¡œì´ë“œ í† ìŠ¤íŠ¸ ë©”ì‹œì§€
        function showAndroidToast(message, duration = 3000) {
            const toast = document.getElementById('androidToast');
            toast.textContent = message;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, duration);
        }

        // ë¹ ë¥¸ ì‘ì—… ë©”ë‰´ í† ê¸€
        function toggleQuickActions() {
            isQuickActionsOpen = !isQuickActionsOpen;
            const quickActions = document.getElementById('quickActions');
            
            if (isQuickActionsOpen) {
                quickActions.classList.add('active');
                androidVibrate(50);
            } else {
                quickActions.classList.remove('active');
            }
        }

        // ì—ë””í„° í¬ì»¤ìŠ¤ (ìƒˆ ê¸°ëŠ¥)
        function focusEditor() {
            textEditor.focus();
            
            const length = textEditor.value.length;
            textEditor.setSelectionRange(length, length);
            
            showAndroidToast('ì—ë””í„°ì— í¬ì»¤ìŠ¤ë˜ì—ˆìŠµë‹ˆë‹¤');
            androidVibrate(50);
            toggleQuickActions();
        }

        // í™”ë©´ ìµœì í™” í† ê¸€ (ì „ì²´í™”ë©´ ëŒ€ì‹ )
        function toggleFullscreen() {
            if (!isFullscreen) {
                isFullscreen = true;
                window.scrollTo(0, 0);
                document.body.style.background = '#000';
                document.querySelector('.mobile-header').style.opacity = '0.95';
                document.querySelector('.stats-bar').style.opacity = '0.9';
                
                showAndroidToast('í™”ë©´ ìµœì í™” ëª¨ë“œ (ìƒíƒœë°” ìœ ì§€)');
                androidVibrate([50, 50]);
            } else {
                isFullscreen = false;
                document.querySelector('.mobile-header').style.opacity = '1';
                document.querySelector('.stats-bar').style.opacity = '1';
                
                showAndroidToast('í™”ë©´ ìµœì í™” í•´ì œ');
                androidVibrate(50);
            }
            
            updateFullscreenButton();
            toggleQuickActions();
        }

        // ë¹ ë¥¸ ì„¤ì • (ìƒˆ ê¸°ëŠ¥)
        function quickSettings() {
            const options = [
                `í°íŠ¸ í¬ê¸°: ${settings.fontSize}px`,
                `ìë™ ì´ˆê¸°í™”: ${settings.autoClearTime === 0 ? 'í•´ì œ' : settings.autoClearTime + 'ì´ˆ'}`,
                `ì§„ë™: ${settings.vibrationEnabled ? 'ON' : 'OFF'}`,
                'ì„¤ì • ì°½ ì—´ê¸°'
            ];
            
            const choice = prompt('ë¹ ë¥¸ ì„¤ì •:\n\n1. ' + options.join('\n2. ') + '\n\në²ˆí˜¸ë¥¼ ì„ íƒí•˜ì„¸ìš” (1-4):');
            
            switch(choice) {
                case '1':
                    showFontSettings();
                    break;
                case '2':
                    showTimeSettings();
                    break;
                case '3':
                    toggleVibration();
                    break;
                case '4':
                    toggleSettings();
                    break;
                default:
                    showAndroidToast('ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤');
            }
            
            toggleQuickActions();
        }

        // í…ìŠ¤íŠ¸ ì´ˆê¸°í™” (ì•ˆë“œë¡œì´ë“œ ìµœì í™”)
        function resetText() {
            textEditor.value = '';
            textEditor.focus();
            resetAutoClearTimer();
            
            androidVibrate([100, 50, 100]);
            showAndroidToast('í…ìŠ¤íŠ¸ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤');
            
            if (isQuickActionsOpen) {
                toggleQuickActions();
            }
        }

        // ì„¤ì • í† ê¸€
        function toggleSettings() {
            document.getElementById('settingsModal').style.display = 'flex';
        }

        function closeSettings() {
            document.getElementById('settingsModal').style.display = 'none';
        }

        // í°íŠ¸ ì„¤ì •
        function showFontSettings() {
            document.getElementById('fontSizeSlider').value = settings.fontSize;
            document.getElementById('currentFontSize').textContent = settings.fontSize + 'px';
            document.getElementById('fontModal').style.display = 'flex';
            closeSettings();
        }

        function applyFontSize() {
            settings.fontSize = parseInt(document.getElementById('fontSizeSlider').value);
            updateUI();
            saveSettings();
            closeFontModal();
        }

        function closeFontModal() {
            document.getElementById('fontModal').style.display = 'none';
        }

        // ì‹œê°„ ì„¤ì •
        function showTimeSettings() {
            document.getElementById('autoTimeSlider').value = settings.autoClearTime;
            document.getElementById('currentAutoTime').textContent = 
                settings.autoClearTime === 0 ? 'í•´ì œ' : settings.autoClearTime + 'ì´ˆ';
            document.getElementById('timeModal').style.display = 'flex';
            closeSettings();
        }

        function applyAutoTime() {
            settings.autoClearTime = parseInt(document.getElementById('autoTimeSlider').value);
            updateUI();
            saveSettings();
            closeTimeModal();
        }

        function closeTimeModal() {
            document.getElementById('timeModal').style.display = 'none';
        }

        // ì§„ë™ í† ê¸€ (ì•ˆë“œë¡œì´ë“œ ìµœì í™”)
        function toggleVibration() {
            settings.vibrationEnabled = !settings.vibrationEnabled;
            updateSettingsDisplay();
            saveSettings();
            
            if (settings.vibrationEnabled) {
                androidVibrate([50, 50, 50]);
                showAndroidToast('ì§„ë™ì´ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤');
            } else {
                showAndroidToast('ì§„ë™ì´ ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤');
            }
        }

        // ìŠ¤ë§ˆíŠ¸ ì§„ë™ í† ê¸€
        function toggleSmartVibration() {
            settings.smartVibration = !settings.smartVibration;
            updateSettingsDisplay();
            saveSettings();
            
            if (settings.smartVibration) {
                showAndroidToast('ìŠ¤ë§ˆíŠ¸ ì§„ë™ì´ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤\n(ì•¼ê°„ì— ì§„ë™ ê°•ë„ ìë™ ì¡°ì ˆ)');
                androidVibrate([30, 30, 100, 30, 30]);
            } else {
                showAndroidToast('ìŠ¤ë§ˆíŠ¸ ì§„ë™ì´ ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤');
                androidVibrate(100);
            }
        }

        // ì‹œê°„ ì´ˆê¸°í™”
        function resetSessionTime() {
            const currentTotal = settings.totalTime - settings.sessionTime;
            settings.totalTime = currentTotal + settings.sessionTime;
            settings.sessionTime = 0;
            updateTimeDisplay();
            saveSettings();
            closeSettings();
        }

        function resetTotalTime() {
            settings.totalTime = 0;
            settings.sessionTime = 0;
            updateTimeDisplay();
            saveSettings();
            closeSettings();
        }

        // ëª¨ë“  ëª¨ë‹¬ ë‹«ê¸°
        function closeAllModals() {
            document.querySelectorAll('.modal').forEach(modal => {
                modal.style.display = 'none';
            });
        }

        // í˜ì´ì§€ ì–¸ë¡œë“œ ì‹œ ë°ì´í„° ì €ì¥
        window.addEventListener('beforeunload', () => {
            saveSettings();
        });

        // í‚¤ë³´ë“œ ì´ë²¤íŠ¸
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeAllModals();
            }
        });

        // ì•± ì´ˆê¸°í™”
        init();
    </script>
</body>
</html>
